PART 1 ‚Äî FIX LIVE TRACKING FOR ALL EMPLOYEES (HIGH PRIORITY)
Current Bug

Admin panel shows live location only for one employee.
Clicking other employees does not load their location.

REQUIRED FIXES
‚≠ê 1 ‚Äî Employee Click Must Load Latest Location

When admin clicks employee card:

Fetch latest tracking record for that employee


API:

GET /tracking/live/{beauticianId}

‚≠ê 2 ‚Äî If Employee Has No Active Order

Fallback logic:

Fetch last known location from tracking table


Even if:

‚Ä¢ Offline
‚Ä¢ Shift ended

Still show last known marker.

‚≠ê 3 ‚Äî If Employee Has Active Order

Show:

Latest location
+ Movement trail
+ Current order details

‚≠ê 4 ‚Äî Admin Map Behavior

When employee clicked:

Center map on employee
Zoom level = 15
Highlight marker
Display info popup:
- Beautician Name
- Order ID
- Status
- Last update timestamp
- Speed

‚≠ê 5 ‚Äî Ensure Tracking Records Exist

Add validation:

Tracking must insert record if:
- Shift active
- OR Order active

‚≠ê 6 ‚Äî Add Real-time Polling

Admin dashboard must refresh tracking every:

10 seconds

‚≠ê 7 ‚Äî Add Debug Logging

If location missing:

console.warn("Tracking missing for employee")


Show fallback banner:

No recent location available

‚úÖ PART 2 ‚Äî START SERVICE TIMER FEATURE (SECONDARY)
‚≠ê PURPOSE

Track service start time + duration countdown.

‚≠ê TRIGGER

Add button on Beautician Order Screen:

Start Service

‚≠ê WHEN BUTTON CLICKED

Save:

service_start_time
order_id
beautician_id


Store in:

order_service_sessions

‚≠ê DATABASE SCHEMA
order_service_sessions

id
order_id
beautician_id
service_start_time
expected_duration_minutes
service_end_time
status

‚≠ê GET EXPECTED DURATION

Pull from Google Sheets Order Data.

Mapping:

Order ‚Üí Service Duration column

‚≠ê UI REQUIREMENTS

After Start Service:

Display LIVE counter:

Service Duration Timer


Format:

Elapsed: 00:45:12

‚≠ê COUNTDOWN WARNING SYSTEM

Show alerts:

When 1 hour remaining ‚Üí Yellow banner
When 30 mins remaining ‚Üí Orange banner
When time exceeded ‚Üí Red banner

‚≠ê TIMER LOGIC

Run front-end interval:

Update every second

‚≠ê STOP SERVICE BUTTON

When beautician clicks:

Stop Service


Save:

service_end_time

‚≠ê ADMIN PANEL ADDITION

Admin must see:

Current service duration
Remaining time
Overtime indicator

‚úÖ PART 3 ‚Äî SERVICE TIMER + TRACKING LINKING

If service running:

Tracking status must auto update:

status = at_location

‚úÖ PART 4 ‚Äî SAFETY FAILOVERS
If Beautician Closes App

Timer must continue using:

server timestamp


NOT frontend clock.

If Internet Lost

Cache locally and sync later.

‚úÖ PART 5 ‚Äî ADMIN DASHBOARD ENHANCEMENT

Add service indicators:

üü¢ On Time
üü° Near Delay
üî¥ Delayed

‚≠ê DELIVERABLES REQUIRED

Provide:

Fix employee tracking loading bug

Map centering + marker highlighting

Tracking fallback system

Service start timer UI

Countdown alerts

Timer persistence logic

Admin timer visibility

END PROMPT